var request = require('request'),
    Promise = require('bluebird'),
    session = require('../resources/session');

module.exports = function (response) {
    return new Promise(function (resolve, reject) {
        request({
            method: 'POST',
            headers: { 'content-type' : 'application/x-www-form-urlencoded' },
            url: response.headers.location,
            body: 'service=*',
            resolveWithFullResponse: true
        }, function (err, res, body) {
            if (err) reject(err);
            session.ticket = body;
            resolve(body);
        });
    });
};
